# 二体问题

- 前置知识
  - 高中物理
    - 经典动力学和运动学在在极坐标下的表示
  - 高中数学
    - 圆锥曲线
  - 微积分以及简单的向量求导，比如见过或了解如下公式:
    - $$\vec{A}\times\vec{B} = \vec{A}\times\frac{\mathrm{d}\vec{B}}{dt} + \frac{\mathrm{d}{\vec{A}}}{dt}\times{\vec{B}}$$

    - $$ \vec{C}\cdot\left(\vec{A}\times\vec{B}\right) = \left(\vec{C}\times\vec{A}\right)\cdot\vec{B}$$




## 二体问题矢量方程

首先给定两个质点$m1,m2$和他们的位置矢量$\vec{r_1},\vec{r_2}$, 以及其质心$C$和质心的位置矢量$\vec{r_c}$和两个质点之间的方向矢量$\vec{r} = \vec{r_1}-\vec{r_2}$,然后用上**质心的性质**$m_1(\vec{r_1}-\vec{r_c}) + m_2(\vec{r_2}-\vec{r_c}) = 0$经过一系列推导，就能够得到:

$$
\vec{r_1} = \vec{r_c} + \frac{m_2}{m_1+m_2}\vec{r}
$$

$$
\vec{r_2} = \vec{r_c} + \frac{m_1}{m_1+m_2}\vec{r}
$$

有了这两个质心的位置矢量，我们就可以利用**牛顿第二定律**和**牛顿第三定律**得到：

$$
\ddot{\vec{r_c}}(m_1+m_2) = 0 \Rightarrow \ddot{\vec{r_c}} = 0
$$

即质心在惯性系下质心加速度为0

以及可以得到
$$
\vec{F_1} = -\vec{F_2} = \frac{m_1 m_2}{m_1+m_2}\ddot{\vec{r}}
$$

然后再结合上**万有引力定律** 
$$\vec{F} = -\frac{G{m_1}{m_2}}{r^3}\ddot{\vec{r}}$$

就可以得到

$$
\frac{m_1 m_2}{m_1+m_2}\ddot{\vec{r}} + \frac{G m_1 m_2}{r^3}\ddot{\vec{r}} = 0
$$

这个就是**二体问题的矢量方程**

令$\mu = G(m_1+m_2)$,就可以写成更简单的形式：
$$
\ddot{\vec{r}} + \frac{\mu}{r^3}\vec{r} = 0
$$

## 二体问题矢量方程的积分常数

上面那一节说明了**二体问题矢量方程** = **牛顿第二定律** + **牛顿第三定律** + **万有引力** + **数学推导**.
这是一个二阶微分方程，接下来，我们需要解这个二阶微分方程。目的是得到其运动规律，包括轨道信息，也就是一个关于$\vec{r}$的方程。其实这个过程就是给微分方程降阶的过程。也就是我们需要挖掘一下这个方程能不能写成$\frac{\mathrm{d}}{\mathrm{d}t}\left(\ldots\right)=0$的形式。括号里面就是**积分常数**。另外，我们需要研究能得到几个积分常数。


### 比角动量常矢量

用$\vec{r}$叉乘矢量结合矢量求导法则方程得到
$$
\frac{\mathrm{d}}{dt}\left(\vec{r}\times\frac{\mathrm{d}\vec{r}}{dt}\right) = 0
$$

这个
$$
\vec{h}=\vec{r}\times\frac{\mathrm{d}\vec{r}}{dt} = \vec{r}\times\vec{v}
$$
就叫**比角动量常矢量**,注意，这个不是角动量，少了一个质量$m$。这也就是为什么叫**比**角动量了，因为这是单位质量的角动量。当然，角动量守恒的必要条件是**有心力**，不一定是平方反比的关系。

### 拉普拉斯常矢量

用矢量方程叉乘$\vec{h}$,就能够得到

$$
\frac{\mathrm{d}^2\vec{r}}{\mathrm{d}t^2}\times\vec{h} + \frac{\mu}{r^3}\vec{r}\times\vec{h}=0
$$

注意到这里的$\vec{h}$是常量，在求导运算里面直接当成常数就可以了，不参与求导。

这里的一系列推到比较麻烦，最后就可以得到：
$$
\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\mathrm{d}\vec{r}}{\mathrm{d}t}\times\vec{h}-\frac{\mu}{r}\vec{r}\right) = 0
$$

定义
$$
\vec{e} = \frac{1}{\mu}\left(\frac{\mathrm{d}\vec{r}}{\mathrm{d}t}\times\vec{h}-\frac{\mu}{r}\vec{r}\right)
$$
为**拉普拉斯常矢量**，这个和**圆锥曲线的偏心率有关**。

$$
\vec{e}\cdot\vec{h} = 0
$$

### 能量常数
用**矢量方程**点乘**速度矢量**，凑全微分，能得到:
$$
\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{1}{2}\dot{\vec{r}}^2-\frac{\mu}{r}\right) = 0
$$
定义
$$
\epsilon = \frac{1}{2}\dot{\vec{r}}^2-\frac{\mu}{r} =\frac{1}{2}v^2 - \frac{\mu}{r}
$$
为**能量常数**，这是一个标量。

如果能量常数乘一个物体的质量，就是这个物体的**机械能**，根据机械能的常用定义，**机械能可以是负的**。从这里也能看出来二体问题的**机械能是守恒**的，当然从更本质上来说，可以参考前章节有关保守力机械能守恒的一般结论。



## 运动方程

关于这个运动方程，一种方法是通过极坐标系来推出**比奈公式**，进而利用万有引力的平方反比关系带入求出二体问题的运动方程，这个方法之前的章节有介绍。这一节我们通过积分常数来列一个关于$\vec{r}$的微分方程。

因为我们有了**拉普拉斯常矢量**这个在**运动平面内的不变量**，在有了$\vec{r}$的前提下，再引入一个角度来来列方程就够了。

$$
\cos{\theta}= \frac{\vec{r}\cdot\vec{e}}{re}
$$

（补图）

里面通过矢量运算法则凑出$\vec{h}$

$$
\vec{r}\cdot\vec{e} = re\cos\theta = \vec{h}^2/(\mu-r)
$$

$$
\vec{r} =  \frac{\vec{h}^2/\mu}{1+e\cos\theta}
$$

令$p=\vec{h}^2/\mu$,**半通径**。

这个和我们之前用比奈公式得到的轨迹是一样的，就是一个**圆锥曲线**。

在这里我们列出这些量和圆锥曲线的一些量之间的关系：
$$
p=\vec{h}^2/\mu
$$

$$
a = \frac{p}{1-e^2}
$$


## 活力公式

活力公式是一个比较常用的公式，我们对航天器的控制在很大程度上都是对速度的控制，活力公式就是描述**速度**与**距离**之间的关系的一个公式。

$$
v^2 = \mu\left(\frac{2}{r}-\frac{1}{a}\right)
$$
其中$a$为圆锥曲线**半长轴**。

这个推导过程略显抽象，暂时我也不太完全能理解，大概过程就是用**拉普拉斯常矢量**的分量，结合其几何意义(补图)。

也就是把**拉普拉斯常矢量**通过平方的方式展开（因为这个常量有比较明显的几何意义）
$$
\vec{e}^2 = \left(用分量\vec{e_1},\vec{e_2}以及一个角度来表示的形式\right)
$$
其中，这个角度和和速度与矢量横向方向的夹角相同。
就可以写出等式
$$
e^2 = 1 + \frac{2h^2}{\mu^2}\epsilon
$$

这个等式表明了之前的**积分常数的数值之间的关系**。通过这个等式可以得到不同形式的量之间的关系，结合上圆锥曲线的定义，就可以表示为半长轴。


比如除了活力公式，
还可以得到：
$$
\epsilon = -\frac{\mu}{2a}
$$,
机械能和半长轴之间乘负反比关系。

### 速度分解
更进一步，根据需求，我们还需要速度分量的公式，在这里，我们直接给出答案，因为无论推导的难易，这个思路却是清晰的，就是表示成极坐标的形式对轨迹方程进行求导。而且本教程在一定程度上是充当手册使用的，不需要给出完全的推导。

径向速度
$$
\vec{v_r} = \frac{\mu}{p}e\sin\theta
$$
横向速度
$$
\vec{v_\theta} = \frac{h}{r}
$$

其中有
$$
\frac{h}{p} = \frac{\mu}{h}= \sqrt{\frac{\mu}{p}}
$$

通过上面的关系，可以写出自己想要的表示速度的方法。


# 二体问题轨道特性

这一小节主要简单列出椭圆轨道，抛物线轨道和双曲线轨道的各种参数的表示。

## 速度分量之间的关系

我们把之前得到的速度分量处理一下就可以发现有如下关系：

$$
\left({v_f-\frac{\mu}{h}}\right)^2+ v_r^2 = \left(\frac{\mu}{h}\right)^2
$$
做一个$v_f$ - $v_r$图像，可以发现这是一个圆。参数和其几何意义对应如下(补图)

## 椭圆轨道的周期
这个可以根据**开普勒第二定律**推出。根据之前的推导掠面速度为常数，这是角动量守恒的必然结果。

$$
T = \frac{A}{\vec{A}} = \frac{\pi ab}{h/2} = 2\pi\sqrt{\frac{a^3}{\mu}}
$$
这正好就是**开普勒第三定律**描述的

轨道只与**半长轴有关**，与**偏心率无关**。也就是与**机械能有关**。

虽然这个是椭圆轨道，但是对于其他圆锥曲线也适用，周期就是无穷大了。


## 抛物线轨道

## 双曲线轨道
对双曲线轨道这种逃逸轨道来讲，比较有用的性质是双曲线的渐近线。
### 双曲剩余速度
双曲线轨道在无穷远处的速度

# 轨道位置$\theta$与时间$t$的关系

我们有
$$
\dot{\theta} = \frac{h}{r^2}
$$

就可以积分得到
$$
t-t_0 = \sqrt{\frac{p^3}{\mu}}\int_{\theta_0}^{\theta}\frac{\mathrm{d}\theta}{\left(1+e\cos\theta\right)^2}
$$

当然对于圆轨道即$e=0$时，有解析解，这个即使不积分，我们也可以很容易的用初等数学的方法得到，因为圆轨道的运动速度是均匀的。

对于椭圆轨道来讲，这是个**椭圆积分**。单纯的椭圆积分没有**初等解析解**。

但是这个还是有办法的，也就是我们用其他变量表示$\theta$。

## 偏近点角

用偏近点角表示椭圆方程。偏近点角的定义如下(补图)。用$E$来表示。

我们把轨道位置的$\theta$用$E$表示：
$$
r\sin\theta = a\sqrt{1-e^2}\sin{E}
$$

用这个等式进行变量替换，把上式平方并且用之前的轨道方程消去$\theta$得到：
$$
r^2 = a^2(1-2e\cos{E}+e^2\cos^2{E})
$$

在开方之前需要进行分类讨论：
- 对于椭圆轨道$r>0, a>0, 0<=e<1$
  - $r = a(1-e\cos{E})$

我们发现，对于用**偏近点角表示的椭圆方程**，在对时间的积分上是在分母中的，这个积分起来就很简单了。

当然我们也得通过之前$\theta$与$E$之间的关系把最后得到的结果换算回来。

$$
\cos{\theta} = \frac{\cos{E}-e}{1-e\cos{E}} \Rightarrow \tan^2{\frac{\theta}{2}} = \frac{1+e}{1-e}\tan^2{\frac{E}{2}}
$$

首先通过画图可知，$\frac{\theta}{2}$与$\frac{E}{2}$在同一象限，就可以展开。
